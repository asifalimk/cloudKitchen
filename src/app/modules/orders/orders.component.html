<mat-drawer-container class="example-container" autosize>
    <mat-drawer #drawer class="example-sidenav" mode="side" position="end">

        <div *ngIf="orderDetails?.order?.content?.status===1||orderDetails?.order?.content?.status===5">
            <!-- <div *ngIf="orderDetails?.order?.content?.readyToDeliver; else notPrepared"></div> -->
            <div mat-dialog-content class="mt-3">
                <div class="mt-1">
                    <mat-card>

                        <mat-card-content>
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <h4 class="m-0 "><span class="fw-500">OrderDetails</span></h4>
                                <span class="fw-500">OrderNo #{{orderDetails?.order?.id}}</span>
                            </div>

                            <mat-list>
                                <mat-list-item> Customer Name: {{orderDetails?.order?.user?.name}} </mat-list-item>
                                <mat-list-item> Mobile: {{orderDetails?.order?.user?.mobile}} </mat-list-item>
                                <mat-list-item> Location: {{orderDetails?.order?.user?.location}} </mat-list-item>

                                <ng-container *ngIf="selectionChanged">
                                    <mat-list-item> Delivery Boy Name: {{selectionChanged.content.name}}
                                    </mat-list-item>
                                    <mat-list-item> Mobile: {{selectionChanged.content.mobile}} </mat-list-item>
                                </ng-container>
                            </mat-list>

                            <!-- <div class="card">
                                <h3>Products</h3>
                            </div> -->


                            <mat-grid-list cols="3" rowHeight="2:1" *ngFor="let is of items">

                                <div class="card">
                                    <h3>{{is[0].category}}</h3>
                                </div>
                                <table mat-table [dataSource]="is" class="mat-elevation-z0 w-100">
                                    <!-- Item Column -->
                                    <ng-container matColumnDef="item">
                                        <th mat-header-cell *matHeaderCellDef> Item </th>
                                        <td mat-cell *matCellDef="let i">{{i?.product?.details?.content?.title}} </td>
                                        <td mat-footer-cell *matFooterCellDef></td>
                                    </ng-container>

                                    <!-- Quantity Column -->
                                    <ng-container matColumnDef="quantity">
                                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                    </ng-container>

                                    <!-- Category Column -->
                                    <ng-container matColumnDef="price">
                                        <th mat-header-cell *matHeaderCellDef> Price </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity*i?.product?.price}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                        <td mat-footer-cell *matFooterCellDef>{{getTotalCost() | currency:'INR'}} </td>
                                    </ng-container>


                                    <tr mat-header-row *matHeaderRowDef="navDetailsColoumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: navDetailsColoumns;"></tr>
                                    <tr mat-footer-row *matFooterRowDef="navDetailsColoumns"></tr>
                                </table>
                            </mat-grid-list>

                        </mat-card-content>
                        <section>
                            <div class="example-button-row" *ngIf="orderDetails?.order?.content?.status===1">
                                <div fxLayoutAlign="flex-end">
                                    <button mat-flat-button color="primary" (click)="onAccept()">Accept</button>
                                    <button mat-flat-button color="primary" (click)="onReject()">Reject</button>
                                </div>

                            </div>
                        </section>

                    </mat-card>
                </div>

            </div>
        </div>

        <div *ngIf="orderDetails?.order?.content?.status===4">
            <!-- <div *ngIf="orderDetails?.order?.content?.readyToDeliver; else notPrepared"></div> -->
            <div mat-dialog-content class="mt-3">
                <div class="mt-1">
                    <mat-card>

                        <mat-card-content>
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <h4 class="m-0 "><span class="fw-500">OrderDetails</span></h4>
                                <span class="fw-500">OrderNo #{{orderDetails?.order?.id}}</span>
                            </div>

                            <mat-list>
                                <mat-list-item> Customer Name: {{orderDetails?.order?.user?.name}} </mat-list-item>
                                <mat-list-item> Mobile: {{orderDetails?.order?.user?.mobile}} </mat-list-item>
                                <mat-list-item> Location: {{orderDetails?.order?.user?.location}} </mat-list-item>
                                <mat-list-item *ngIf="!orderDetails?.order?.content?.deliveryBoy; else deliveryBoy">
                                    <mat-form-field>
                                        <mat-label>Select Delivery Staff</mat-label>
                                        <mat-select (selectionChange)="onChangeSelect($event)">
                                            <mat-option *ngFor="let deliveryBoy of deliveryBoys"
                                                [value]="deliveryBoy.id">
                                                {{deliveryBoy?.content?.name}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </mat-list-item>
                                <ng-template #deliveryBoy>
                                    <mat-list-item> Delivery Boy Name:
                                        {{orderDetails?.order?.deliveryBoy?.content?.name}}
                                    </mat-list-item>
                                    <mat-list-item> Mobile: {{orderDetails?.order?.deliveryBoy?.content?.mobile}}
                                    </mat-list-item>
                                </ng-template>
                                <ng-container *ngIf="selectionChanged">
                                    <mat-list-item> Delivery Boy Name: {{selectionChanged.content.name}}
                                    </mat-list-item>
                                    <mat-list-item> Mobile: {{selectionChanged.content.mobile}} </mat-list-item>
                                </ng-container>
                            </mat-list>

                            <!-- <div class="card">
                                <h3>Products</h3>
                            </div> -->


                            <mat-grid-list cols="3" rowHeight="2:1">
                                <!-- <mat-grid-tile>
                                    <div class="card">
                                        <h3>{{is[0].category}}</h3>
                                    </div>
                                </mat-grid-tile> -->
                                <table mat-table [dataSource]="items" class="mat-elevation-z0 w-100">
                                    <!-- Item Column -->
                                    <ng-container matColumnDef="item">
                                        <th mat-header-cell *matHeaderCellDef> Item </th>
                                        <td mat-cell *matCellDef="let i">{{i?.product?.details?.content?.title}} </td>
                                        <td mat-footer-cell *matFooterCellDef></td>
                                    </ng-container>

                                    <!-- Quantity Column -->
                                    <ng-container matColumnDef="quantity">
                                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                    </ng-container>

                                    <!-- Category Column -->
                                    <ng-container matColumnDef="price">
                                        <th mat-header-cell *matHeaderCellDef> Price </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity*i?.product?.price}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                        <td mat-footer-cell *matFooterCellDef>{{getTotalCost() | currency:'INR'}} </td>
                                    </ng-container>


                                    <tr mat-header-row *matHeaderRowDef="navDetailsColoumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: navDetailsColoumns;"></tr>
                                    <tr mat-footer-row *matFooterRowDef="navDetailsColoumns"></tr>
                                </table>
                            </mat-grid-list>

                        </mat-card-content>
                        <div fxLayoutAlign="flex-end" *ngIf="!orderDetails?.order?.content?.deliveryBoy">
                            <button mat-flat-button color="primary" [disabled]="!selectionChanged"
                                (click)="onOrderUpdate()">Save</button>
                        </div>
                        <section>
                            <div class="example-button-row">
                                <div fxLayoutAlign="flex-end">
                                    <button mat-flat-button color="primary"
                                        (click)="onDeliveryDetailsEdit()">Edit</button>
                                    <button mat-flat-button color="primary" (click)="onDispatched()">Dispatched</button>
                                </div>
                            </div>
                        </section>
                    </mat-card>
                </div>
            </div>
        </div>
        <!-- <div *ngIf="setDeliveryBoy;delivery"></div> -->
        <!-- <ng-template *ngIf="setDeliveryBoy;delivery" #delivery> -->
        <!-- <div *ngIf="orderDetails?.order?.content?.readyToDeliver; else notPrepared"></div> -->
        <div *ngIf="orderDetails?.order?.content?.status===3||setDeliveryBoy">
            <div mat-dialog-content class="mt-3">
                <div class="mt-1">
                    <mat-card>
                        <mat-card-content>
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <h4 class="m-0 "><span class="fw-500">OrderDetails</span></h4>
                                <span class="fw-500">OrderNo #{{orderDetails?.order?.id}}</span>
                            </div>

                            <mat-list>
                                <mat-list-item> Customer Name: {{orderDetails?.order?.user?.name}} </mat-list-item>
                                <mat-list-item> Mobile: {{orderDetails?.order?.user?.mobile}} </mat-list-item>
                                <mat-list-item> Location: {{orderDetails?.order?.user?.location}} </mat-list-item>
                                <mat-list-item>
                                    <mat-form-field>
                                        <mat-label>Select Delivery Staff</mat-label>
                                        <mat-select (selectionChange)="onChangeSelect($event)">
                                            <mat-option *ngFor="let deliveryBoy of deliveryBoys"
                                                [value]="deliveryBoy.id">
                                                {{deliveryBoy?.content?.name}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </mat-list-item>

                                <ng-container *ngIf="selectionChanged">
                                    <mat-list-item> Delivery Boy Name: {{selectionChanged.content.name}}
                                    </mat-list-item>
                                    <mat-list-item> Mobile: {{selectionChanged.content.mobile}} </mat-list-item>
                                </ng-container>
                            </mat-list>

                            <!-- <div class="card">
                                <h3>Products</h3>
                            </div> -->


                            <mat-grid-list cols="3" rowHeight="2:1">
                                <!-- <mat-grid-tile>
                                    <div class="card">
                                        <h3>{{is[0].category}}</h3>
                                    </div>
                                </mat-grid-tile> -->
                                <table mat-table [dataSource]="items" class="mat-elevation-z0 w-100">
                                    <!-- Item Column -->
                                    <ng-container matColumnDef="item">
                                        <th mat-header-cell *matHeaderCellDef> Item </th>
                                        <td mat-cell *matCellDef="let i">{{i?.product?.details?.content?.title}} </td>
                                        <td mat-footer-cell *matFooterCellDef></td>
                                    </ng-container>

                                    <!-- Quantity Column -->
                                    <ng-container matColumnDef="quantity">
                                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                    </ng-container>

                                    <!-- Category Column -->
                                    <ng-container matColumnDef="price">
                                        <th mat-header-cell *matHeaderCellDef> Price </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity*i?.product?.price}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                        <td mat-footer-cell *matFooterCellDef>{{getTotalCost() | currency:'INR'}} </td>
                                    </ng-container>


                                    <tr mat-header-row *matHeaderRowDef="navDetailsColoumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: navDetailsColoumns;"></tr>
                                    <tr mat-footer-row *matFooterRowDef="navDetailsColoumns"></tr>
                                </table>
                            </mat-grid-list>

                        </mat-card-content>
                        <div fxLayoutAlign="flex-end" >
                            <button mat-flat-button color="primary" [disabled]="!selectionChanged"
                                (click)="onOrderUpdate()">Save</button>
                        </div>
                    </mat-card>
                </div>
            </div>
        </div>
        <!-- </ng-template> -->

        <div *ngIf="orderDetails?.order?.content?.status===2">
            <div mat-dialog-content class="mt-3">
                <div class="mt-1">
                    <mat-card>
                        <mat-card-content>
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <h4 class="m-0 "><span class="fw-500">OrderDetails</span></h4>
                                <span class="fw-500">OrderNo #{{orderDetails?.order?.id}}</span>
                            </div>
                            <!-- <div class="card">
                                <h3>Products</h3>
                            </div> -->


                            <mat-grid-list cols="3" rowHeight="2:1" *ngFor="let is of items">

                                <div class="card">
                                    <h3>{{is[0].category}}</h3>
                                </div>

                                <table mat-table [dataSource]="is" class="mat-elevation-z0 w-100">
                                    <!-- Item Column -->
                                    <ng-container matColumnDef="item">
                                        <th mat-header-cell *matHeaderCellDef> Item </th>
                                        <td mat-cell *matCellDef="let i">{{i?.product?.details?.content?.title}} </td>
                                        <td mat-footer-cell *matFooterCellDef></td>
                                    </ng-container>

                                    <!-- Quantity Column -->
                                    <ng-container matColumnDef="quantity">
                                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                                        <td mat-cell *matCellDef="let i">{{i?.quantity}} </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                    </ng-container>

                                    <!-- Status -->
                                    <ng-container matColumnDef="status">
                                        <th mat-header-cell *matHeaderCellDef> Status </th>
                                        <td mat-cell *matCellDef="let i">
                                            <div class="form-check">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="checkbox"
                                                        [checked]="i.prepared" (change)="checkValue($event)"
                                                        value="{{i.product_id}}">
                                                    <span class="form-check-sign">
                                                        <span class="check"></span>
                                                    </span>
                                                </label>
                                            </div>
                                        </td>
                                        <td mat-footer-cell *matFooterCellDef> </td>
                                    </ng-container>
                                    <tr mat-header-row *matHeaderRowDef="navColoumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: navColoumns;"></tr>
                                    <tr mat-footer-row *matFooterRowDef="navColoumns"></tr>
                                </table>
                            </mat-grid-list>
                        </mat-card-content>
                    </mat-card>
                </div>

            </div>
        </div>

    </mat-drawer>
    <div class="orders-component" fxLayout="column" fxLayoutGap="20px">

        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-warning" fxLayoutAlign="center center">
                    <mat-icon>pending_actions</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[0]?.count}}</h2>
                <p class="card-category">Pending</p>
            </mat-card>

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-info" fxLayoutAlign="center center">
                    <mat-icon>task_alt</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[1]?.count}}</h2>
                <p class="card-category">Accepted</p>
            </mat-card>

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-primary" fxLayoutAlign="center center">
                    <mat-icon>shopping_bag</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[2]?.count}}</h2>
                <p class="card-category">Packed</p>
            </mat-card>

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-danger" fxLayoutAlign="center center">
                    <mat-icon>verified_user</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[3]?.count}}</h2>
                <p class="card-category">Assigned</p>
            </mat-card>

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-info" fxLayoutAlign="center center">
                    <mat-icon>flight</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[4]?.count}}</h2>
                <p class="card-category">Dispatched</p>
            </mat-card>
            

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-success" fxLayoutAlign="center center">
                    <mat-icon>assignment_turned_in</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[5]?.count}}</h2>
                <p class="card-category">Delivered</p>
            </mat-card>


            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-danger" fxLayoutAlign="center center">
                    <mat-icon>report</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[6]?.count}}</h2>
                <p class="card-category">Rejected</p>
            </mat-card>

            <mat-card fxFlex="24" class="mat-elevation-z card" fxLayout="column" fxLayoutAlign="center center">
                <div class="bordered-icon bg-warning" fxLayoutAlign="center center">
                    <mat-icon>cancel</mat-icon>
                </div>
                <h2 class="m-0">{{orderStatus[7]?.count}}</h2>
                <p class="card-category">Canceled</p>
            </mat-card>

        </div>

        <div class="w-100">
            <app-table-widget *ngIf="tableWidgetData" [tableData]="tableWidgetData"
                (matMenuClicked)="menuClicked($event)" (rowClicked)="rowClicked($event)"
                (buttonClicked)="buttonClicked($event)">
            </app-table-widget>
        </div>

    </div>
</mat-drawer-container>